# AlphaTransformQlib
AlphaTransformQlib is a Reinforcement Learning-based Alpha Gneration and Alpha Backtesting Stock Prediciton System.

To be more specific, this repository (Stock Prediction System) contains two parts: AlphaTransform and [Qlib](https://github.com/microsoft/qlib/edit/main/README.md). It successfully links these two parts and packages them into a new stock prediction system.

## AlphaTransform

AlphaTransform contains a formulaic alpha generator using Reinforcement Learning (with a Transformer as the policy network) in `alphagen`, as well as a backtesting system in `backtester` that tests alphas generated by the alpha generator that can be used to train and test the alpha generator. 

## Qlib

Qlib is an open-source, AI-oriented quantitative investment platform that aims to realize the potential, empower research, and create value using AI technologies in quantitative investment, from exploring ideas to implementing productions.

# Architecture
Here is a high-level overview of AlphaTransformQlib's architecture:

# Usage
## Config
The default parameters in `config.py` works on the input data provided in the `data` directory, but feel free to change the parameters if necessary (e.g. if using your own dataset or additional operators). 
The training of the RL agent will depend on these specified parameters. 

## Training
To train a model on the provided data in the `data` directory, run:
```bash
python3 train_maskable_ppo.py <seed> <loss_metric> <num_steps>
```
where `<seed>` is any integer serving as a random seed for reproducible output, and `<loss_metric>` is a choice of `IC`, `RIC`, or `Sharpe`.
`<num_steps>` refers to the number of steps that the RL training loop will run for, and is an optional parameter (with a default of 100,000). 

An example training command is:
```bash
python3 train_maskable_ppo.py 42 Sharpe
```

## Testing
To test a previously trained model, run:
```bash
python3 test_maskable_ppo.py <checkpoint_path> <num_distinct_alphas_to_generate> 
```
where `<checkpoint_path>` is the file path of the saved model checkpoint.
`<num_distinct_alphas_to_generate>` is the number of distinct alphas (with unique loss values) to generate in the batch, 
and is an optional parameter (with a default of 100). 

## Tokenize and Calculate Alpha Expressions

## 
